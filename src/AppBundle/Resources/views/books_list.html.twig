{% extends 'base.html.twig' %}

{% block title %}Book list {% endblock %}

{% block body %}
    <h2 class="book-name"></h2>

    <div class="book-container">
        <div class="row">
            <div class="col-sm-4">
        <div class="book-photo"></div>
            <div class="book-details">
            <dl class="book-details-list">
            {% for book in book_list %}
                <tr>
                    <dt>Title</dt>
                    <td>{{ book.title }}</td>
                    <dt>Author</dt>
                    <td>{{ book.author }}</td>
                    <dt>Release year</dt>
                    <td>{{ book.releaseYear|date }}</td>
                    <dt>Language</dt>
                    <td>{{ book.language }}</td>
                    <dt>Pages number</dt>
                    <td>{{ book.pagesNumber }}</td>
                </tr>
            {% endfor %}
            </dl>
            </div>
            </div>
        </div>
        <div class="col-sm-1"></div>
            <div class="col-sm-7">
                <table width="100%" cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered table-hover table-condensed dt">
                    <thead>
                    <tr>
                        <th>{{'User'|trans({}, 'fields')}}</th>
                        <th>{{'Note'|trans({}, 'fields')}}</th>
                        <th>
                            {% if is_granted('ROLE_USER') %}
                                <a href="{{ path('note_new') }}"
                                   role="button" class="btn btn-xs btn-main">
                                    <i class="glyphicon glyphicon-plus icon-white"></i></a>
                            {% endif %}
                        </th>
                    </tr>
                    </thead>
                <tbody>
                {% for note in book_notes %}
                <tr>
                    <td>{{ note.username }}</td>
                    <td>{{ note.note }}</td>
                    <td>
                        {% if is_granted('ROLE_USER') %}
                            {% if note.userEmail == app.user.email or is_granted('ROLE_ADMIN') %}
                                <div class="btn-toolbar nomargin">
                                    <div class="btn-group">
                                        <a data-toggle="modal-ajax"
                                           data-title="{{'Edit Note'|trans({}, 'default')}}"
                                           data-callback="reloadTab"
                                           data-target="#invModal"
                                           href="{{ path('note_edit', {'id': note.id}) }}"
                                           class="btn btn-default btn-xs"><i class="glyphicon glyphicon-pencil"></i></a>
                                        <a data-record="{{ note.id }}"
                                           data-msg="{{ note.note }}"
                                           href="{{ path('note_delete', {'entityId': note.id}) }}"
                                           data-callback="reloadTab"
                                           class="btn btn-default btn-xs delete"
                                           onclick="return confirm('Are you sure you want to delete this note?')"><i class="glyphicon glyphicon-remove"></i></a>
                                    </div>
                                </div>
                            {% endif %}
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
                </tbody>
                </table>
                </div>
                </div>
    </div>

    {#<a href="{{ path('note_new') }}">New note</a>#}

    {#<div id="js-notes-wrapper"></div>#}

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.3/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.3/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>

    <script type="text/babel" src="{{ asset('js/notes.react.js') }}"></script>
    <script type="text/babel">
        var notesUrl = '{{ path('book_notes', {'entityId': entityId}) }}';

        ReactDOM.render(
                <NoteSection url={notesUrl} />,
            document.getElementById('js-notes-wrapper')
        );

    </script>
{% endblock %}